<form id="campaignForm">
    <div>
        <label>活動名稱</label>
        <input type="text" name="CampaignName" />
    </div>
    <div>
        <label>活動類型</label>
        <select name="CampaignType">
            <option value="cmd">滿額折扣</option>
            <option value="csd">全館折扣</option>
        </select>
    </div>
    <div>
        <label>活動描述</label>
        <input type="text" name="CampaignDescription" />
    </div>
    <div>
        <label>適用商品類型</label>
        <input type="checkbox" name="ProductType" value="eyes" />眼睛保健
        <input type="checkbox" name="ProductType" value="skin" />皮膚護理
        <input type="checkbox" name="ProductType" value="hair" />頭髮護理
        <input type="checkbox" name="ProductType" value="face" />臉部護理
    </div>
    <div>
        <label>活動開始日期</label>
        <input type="date" name="StartDate" />
    </div>
    <div>
        <label>活動結束日期</label>
        <input type="date" name="EndDate" />
    </div>
    <div>
        <label>是否啟用</label>
        <input type="radio" name="IsActive" value="true" />啟用
        <input type="radio" name="IsActive" value="false" />未啟用
    </div>
    <div>
        <label>活動狀態</label>
        <select name="Status">
            <option value="cActive">Active</option>
            <option value="cInactive">Inactive</option>
        </select>
    </div>
    <div>
        <label>建檔人員</label>
        <input type="text" name="Creator" />
    </div>
    <div>
        <label>活動圖片Id</label>
        <input type="text" name="ImgId" />
    </div>
    <div>
        <button type="button" id="submitBtn">確認</button>
    </div>
</form>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        $("#submitBtn").on("click", function(e){
            e.preventDefault();

            var data = {
                CampaignName: $("input[name='CampaignName']").val(),
                CampaignType: $("select[name='CampaignType']").val(),
                CampaignDescription: $("input[name='CampaignDescription']").val(),
                ProductType: $("input[name='ProductType']:checked").map(function(){ return this.value; }).get().join(","), // 轉字串
                StartDate: $("input[name='StartDate']").val() || null,
                EndDate: $("input[name='EndDate']").val() || null,
                IsActive: $("input[name='IsActive']:checked").val() === "true",
                Status: $("select[name='Status']").val(),
                Creator: parseInt($("input[name='Creator']").val()),
                ImgId: parseInt($("input[name='ImgId']").val()) || null
            };

            $.ajax({
                url: "/MKT/Campaigns/CreatCampaign",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function(res){
                    if(res.success){
                        Swal.fire("成功","活動已新增！","success");
                    } else {
                        Swal.fire("錯誤","新增失敗：" + res.message,"error");
                    }
                },
                error: function(xhr,status,error){
                    Swal.fire("錯誤","新增失敗：" + xhr.responseText,"error");
                }
            });
        });
    </script>
}
