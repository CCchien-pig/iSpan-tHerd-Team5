@using System.Text.Json
@using System.Net

@{
    // 先取出 TempData / ViewBag
    var rawSuccess = TempData["SuccessMessage"] ?? ViewBag.SuccessMessage;
    var rawError = ViewBag.ErrorMessage ?? TempData["ErrorMessage"];

    // 強制 HTML 解碼（避免 &#xxxx;）
    var success = rawSuccess != null ? WebUtility.HtmlDecode(rawSuccess.ToString()) : null;
    var error = rawError != null ? WebUtility.HtmlDecode(rawError.ToString()) : null;
}

@if (!string.IsNullOrWhiteSpace(success))
{
    <script>
        Swal.fire({
            icon: 'success',
            title: '操作成功',
            text: @Html.Raw(JsonSerializer.Serialize(success)) // 輸出合法 JS 字串
        });
    </script>
}

@if (!string.IsNullOrWhiteSpace(error))
{
    <script>
        Swal.fire({
            icon: 'error',
            title: '操作失敗',
            text: @Html.Raw(JsonSerializer.Serialize(error))
        });
    </script>
}
