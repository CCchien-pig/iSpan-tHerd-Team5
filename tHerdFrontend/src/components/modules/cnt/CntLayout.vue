<template>
  <div class="d-flex min-vh-100 cnt-layout">
    <!-- 左側選單 -->
    <aside class="sidebar bg-light border-end p-3 shadow-sm">
      <h5 class="main-color-green-text mb-3">健康中心</h5>

      <ul class="list-unstyled">
        <!-- 📰 健康文章 -->
        <li>
          <button
            class="btn w-100 text-start fw-semibold mb-2 sidebar-btn"
            @click="toggle('articles')"
          >
            <i class="bi bi-journal-text me-1"></i> 健康文章
            <span class="float-end" :class="{ 'rotate-90': openMenu === 'articles' }">›</span>
          </button>

          <transition name="expand">
            <ul v-show="openMenu === 'articles'" class="submenu ps-3 small">
              <li>
                <router-link to="/cnt/articles" class="submenu-link" active-class="active-link">
                  全部文章
                </router-link>
              </li>
              <li
                v-for="cat in articleCats"
                :key="cat"
              >
                <router-link
                  :to="{ name: 'cnt-articles', query: { category: cat } }"
                  class="submenu-link"
                  active-class="active-link"
                >
                  {{ cat }}
                </router-link>
              </li>
            </ul>
          </transition>
        </li>

        <!-- 🧪 營養分析 -->
        <li class="mt-3">
          <button
            class="btn w-100 text-start fw-semibold mb-2 sidebar-btn"
            @click="toggle('nutrition')"
          >
            <i class="bi bi-clipboard-data me-1"></i> 營養分析
            <span class="float-end" :class="{ 'rotate-90': openMenu === 'nutrition' }">›</span>
          </button>

          <transition name="expand">
            <ul v-show="openMenu === 'nutrition'" class="submenu ps-3 small">
              <li>
                <router-link
                  to="/cnt/nutrition"
                  class="submenu-link"
                  active-class="active-link"
                >
                  單項食材分析
                </router-link>
              </li>
              <li>
                <router-link
                  to="/cnt/nutrition/compare"
                  class="submenu-link"
                  active-class="active-link"
                >
                  多項食材比較
                </router-link>
              </li>
            </ul>
          </transition>
        </li>
      </ul>
    </aside>

    <!-- 主內容 -->
    <main class="flex-grow-1 p-4 bg-white">
      <router-view />
    </main>
  </div>
</template>

<script setup>
import { ref } from "vue"

const openMenu = ref(null)
const articleCats = ["健康飲食", "運動營養", "保健知識"]

function toggle(menu) {
  openMenu.value = openMenu.value === menu ? null : menu
}
</script>

<style scoped>
/* 側邊欄 */
.sidebar {
  width: 240px;
  transition: all 0.3s ease;
}
.sidebar-btn {
  color: #004c4c;
  background: #f9f9f9;
  border-radius: 8px;
}
.sidebar-btn:hover {
  background: #e7f4f2;
  color: #007078;
}
.submenu {
  overflow: hidden;
  padding-top: 4px;
}
.submenu-link {
  display: block;
  padding: 6px 10px;
  border-radius: 6px;
  color: #007078;
  text-decoration: none;
}
.submenu-link:hover {
  background: #d8f1ef;
}
.active-link {
  font-weight: 600;
  color: #004c4c !important;
  background: #c9ebe7;
}

/* 展開動畫 */
.expand-enter-active,
.expand-leave-active {
  transition: all 0.25s ease-out;
}
.expand-enter-from,
.expand-leave-to {
  max-height: 0;
  opacity: 0;
}
.expand-enter-to,
.expand-leave-from {
  max-height: 200px;
  opacity: 1;
}

/* ›箭頭旋轉動畫 */
.rotate-90 {
  display: inline-block;
  transform: rotate(90deg);
  transition: transform 0.25s ease;
}
</style>
